getwd()
library(readr)
library(dplyr)
raw <- read_csv("data_raw/your_file.csv")
library(readr)
library(dplyr)
raw <- read_csv("data_raw/GEDEvent_v25_1.csv")
glimpse(raw)
library(readr)
library(dplyr)
raw <- read_csv
raw <- read_csv("data_raw/GEDEvent_v25_1.csv")
glimpse(raw)
conflict_recent <- raw %>%
filter(year >= 2000)
write_csv(conflict_recent, "data/conflict_recent.csv")
library(readr)
library(dplyr)
raw <- read_csv("data_raw/GEDEvent_v25_1.csv", show_col_types = FALSE)
country_year <- raw %>%
filter(year >= 2000) %>%
group_by(country, year) %>%
summarise(
events = n(),
deaths_best = sum(best, na.rm = TRUE),
deaths_civilians = sum(deaths_civilians, na.rm = TRUE),
.groups = "drop"
)
write_csv(country_year, "data/country_year_summary.csv")
nrow(country_year)
range(country_year$year)
arrange(country_year, desc(events)) %>% head(10)
raw %>%
distinct(country, country_id) %>%
arrange(country) %>%
head(10)
library(countrycode)
country_year <- country_year %>%
mutate(iso3 = countrycode(country, "country.name", "iso3c"))
sum(is.na(country_year$iso3))
library(dplyr)
library(countrycode)
na_countries <- country_year %>%
filter(is.na(iso3)) %>%
distinct(country) %>%
arrange(country)
na_countries
country_year <- country_year %>%
mutate(country_std = if_else(country == "Yemen (North Yemen)", "Yemen", country)) %>%
mutate(iso3 = countrycode(country_std, "country.name", "iso3c"))
sum(is.na(country_year$iso3))
write_csv(country_year, "data/country_year_summary.csv")
country_year %>% filter(country == "Yemen (North Yemen)") %>% distinct(country, country_std, iso3)
sum(is.na(country_year$iso3))
write_csv(country_year, "data/country_year_summary.csv")
# 6.1 Cleaning
library(sf)
library(dplyr)
world <- st_read("data/world_countries.geojson", quiet = TRUE)
# 6.1 Cleaning
library(sf)
library(dplyr)
world <- st_read("data/world_countries.geojson", quiet = TRUE)
# 6.1 Cleaning
library(sf)
library(dplyr)
world <- st_read("data/countries.geojson", quiet = TRUE)
names(world)
# to match and see as `ISO3166-1-Alpha-3`
world2 <- world %>%
rename(
iso3 = `ISO3166-1-Alpha-3`,
name = name
)
# 6.1 Cleaning
library(sf)
library(dplyr)
world <- st_read("data/countries.geojson", quiet = TRUE)
names(world)
# to match and see as `ISO3166-1-Alpha-3`
world2 <- world %>%
rename(
iso3 = ISO3166.1.Alpha.3,
name = name
)
st_write(world2, "data/world_countries_iso3.geojson", delete_dsn = TRUE)
names(world2)
st_write(world2, "data/world_countries_iso3.geojson", delete_dsn = TRUE)
country_year <- country_year %>%
rename(events_count = events)
names(country_year)
country_year <- raw %>%
filter(year >= 2000) %>%
group_by(country, iso3, year) %>%
summarise(
events_count = n(),
deaths_best = sum(best, na.rm = TRUE),
.groups = "drop"
) %>%
mutate(
fatality_rate = deaths_best / events_count
)
rlang::last_trace()
rlang::last_trace(drop = FALSE)
library(dplyr)
library(countrycode)
country_year <- raw %>%
filter(year >= 2000) %>%
group_by(country, year) %>%
summarise(
events_count = n(),
deaths_best  = sum(best, na.rm = TRUE),
.groups = "drop"
) %>%
mutate(
country_std = if_else(country == "Yemen (North Yemen)", "Yemen", country),
iso3 = countrycode(country_std, "country.name", "iso3c"),
fatality_rate = deaths_best / events_count
)
sum(is.na(country_year$iso3))   # ควรได้ 0
write_csv(country_year, "data/country_year_summary.csv")
names(country_year)
country_year <- country_year %>%
select(country, iso3, year, events_count, deaths_best, fatality_rate)
names(country_year)
write_csv(country_year, "data/country_year_summary.csv")
country_year <- country_year %>%
mutate(fatality_rate = round(fatality_rate, 3))
write_csv(country_year, "data/country_year_summary.csv")
